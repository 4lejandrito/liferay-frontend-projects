!function(e,t){var n=t();"object"==typeof module&&module&&(module.exports=n),"function"==typeof define&&define.amd&&define(t),e.PromisePolyfill=n,e.Promise||(e.Promise=n)}("undefined"!=typeof global?global:this,function(){function e(e){return"[object Array]"===Object.prototype.toString.call(e)}function t(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function n(e){if(!(this instanceof n))return n._log("Promises should always be created with new Promise(). This will throw an error in the future","error"),new n(e);var t=new n.Resolver(this);this._resolver=t;try{e(function(e){t.resolve(e)},function(e){t.reject(e)})}catch(r){t.reject(r)}}function r(e){this._callbacks=[],this._errbacks=[],this.promise=e,this._status="pending",this._result=null}return t(n.prototype,{then:function(e,t){var r,i,o=new this.constructor(function(e,t){r=e,i=t});return this._resolver._addCallbacks("function"==typeof e?n._makeCallback(o,r,i,e):r,"function"==typeof t?n._makeCallback(o,r,i,t):i),o},"catch":function(e){return this.then(void 0,e)}}),n._makeCallback=function(e,t,n,r){return function(i){var o;try{o=r(i)}catch(s){return void n(s)}return o===e?void n(new TypeError("Cannot resolve a promise with itself")):void t(o)}},n._log=function(e,t){"undefined"!=typeof console&&console[t](e)},n.resolve=function(e){return e&&e.constructor===this?e:new this(function(t){t(e)})},n.reject=function(e){var t=new this(function(){});return t._resolver._result=e,t._resolver._status="rejected",t},n.all=function(t){var n=this;return new n(function(r,i){function o(e){return function(t){l[e]=t,s--,s||r(l)}}if(!e(t))return void i(new TypeError("Promise.all expects an array of values or promises"));var s=t.length,u=0,a=t.length,l=[];if(1>a)return r(l);for(;a>u;u++)n.resolve(t[u]).then(o(u),i)})},n.race=function(t){var n=this;return new n(function(r,i){if(!e(t))return void i(new TypeError("Promise.race expects an array of values or promises"));for(var o=0,s=t.length;s>o;o++)n.resolve(t[o]).then(r,i)})},n.async="undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof process&&process.nextTick?process.nextTick:function(e){setTimeout(e,0)},t(r.prototype,{fulfill:function(e){var t=this._status;("pending"===t||"accepted"===t)&&(this._result=e,this._status="fulfilled"),"fulfilled"===this._status&&(this._notify(this._callbacks,this._result),this._callbacks=[],this._errbacks=null)},reject:function(e){var t=this._status;("pending"===t||"accepted"===t)&&(this._result=e,this._status="rejected",this._errbacks.length||n._log("Promise rejected but no error handlers were registered to it","info")),"rejected"===this._status&&(this._notify(this._errbacks,this._result),this._callbacks=null,this._errbacks=[])},resolve:function(e){"pending"===this._status&&(this._status="accepted",this._value=e,(this._callbacks&&this._callbacks.length||this._errbacks&&this._errbacks.length)&&this._unwrap(this._value))},_unwrap:function(e){var t,n=this,r=!1;if(!e||"object"!=typeof e&&"function"!=typeof e)return void n.fulfill(e);try{t=e.then,"function"==typeof t?t.call(e,function(e){r||(r=!0,n._unwrap(e))},function(e){r||(r=!0,n.reject(e))}):n.fulfill(e)}catch(i){r||n.reject(i)}},_addCallbacks:function(e,t){var n=this._callbacks,r=this._errbacks;switch(n&&n.push(e),r&&r.push(t),this._status){case"accepted":this._unwrap(this._value);break;case"fulfilled":this.fulfill(this._result);break;case"rejected":this.reject(this._result)}},_notify:function(e,t){e.length&&n.async(function(){var n,r;for(n=0,r=e.length;r>n;++n)e[n](t)})}}),n.Resolver=r,n}),function(){var global={};global.__CONFIG__=window.__CONFIG__,function(e,t){"use strict";var n=t(e);"object"==typeof module&&module&&(module.exports=n),"function"==typeof define&&define.amd&&define(t),e.PathResolver=n}("undefined"!=typeof global?global:this,function(){"use strict";function e(){}return e.prototype={constructor:e,resolvePath:function(e,t){if("exports"===t)return t;var n=e.split("/");n.splice(-1);for(var r=t.split("/"),i=r.splice(-1),o=0;o<r.length;o++){var s=r[o];if("."!==s)if(".."===s){if(!n.length){n=n.concat(r.slice(o));break}n.splice(-1,1)}else n.push(s)}return n.push(i),n.join("/")}},e}),function(e,t){"use strict";var n=t(e);"object"==typeof module&&module&&(module.exports=n),"function"==typeof define&&define.amd&&define(t),e.EventEmitter=n}("undefined"!=typeof global?global:this,function(){"use strict";function e(){this._events={}}return e.prototype={constructor:e,on:function(e,t){var n=this._events[e]=this._events[e]||[];n.push(t)},off:function(e,t){var n=this._events[e];if(n){var r=n.indexOf(t);r>-1?n.splice(r,1):console.warn("Off: callback was not removed: "+t.toString())}else console.warn("Off: there are no listeners for event: "+e)},emit:function(e,t){var n=this._events[e];if(n){n=n.slice(0);for(var r=0;r<n.length;r++){var i=n[r];i.call(i,t)}}else console.warn("No listeners for event: "+e)}},e}),function(e,t){"use strict";var n=t(e);"object"==typeof module&&module&&(module.exports=n),"function"==typeof define&&define.amd&&define(t),e.ConfigParser=n}("undefined"!=typeof global?global:this,function(e){"use strict";function t(e){this._config={},this._modules={},this._conditionalModules={},this._parseConfig(e)}var n=Object.prototype.hasOwnProperty;return t.prototype={constructor:t,addModule:function(e){this._modules[e.name]=e,this.resolvePath(e),this._registerConditionalModule(e)},getConfig:function(){return this._config},getConditionalModules:function(){return this._conditionalModules},getModules:function(){return this._modules},resolvePath:function(e){for(var t=e.dependencies,n=0;n<t.length;n++){var r=this._getPathResolver().resolvePath(e.name,t[n]);t[n]=r}},_getPathResolver:function(){return this._pathResolver||(this._pathResolver=new e.PathResolver),this._pathResolver},_parseConfig:function(e){for(var t in e)n.call(e,t)&&("modules"===t?this._parseModules(e[t]):this._config[t]=e[t]);return this._config},_parseModules:function(e){for(var t in e)if(n.call(e,t)){var r=e[t];r.name=t,this.addModule(r)}return this._modules},_registerConditionalModule:function(e){if(e.condition){var t=this._conditionalModules[e.condition.trigger];t||(this._conditionalModules[e.condition.trigger]=t=[]),t.push(e.name)}}},t}),function(e,t){"use strict";var n=t(e);"object"==typeof module&&module&&(module.exports=n),"function"==typeof define&&define.amd&&define(t),e.DependencyBuilder=n}("undefined"!=typeof global?global:this,function(global){"use strict";function DependencyBuilder(e){this._configParser=e,this._result=[]}var hasOwnProperty=Object.prototype.hasOwnProperty;return DependencyBuilder.prototype={constructor:DependencyBuilder,resolveDependencies:function(e){this._queue=e.slice(0);var t;try{this._resolveDependencies(),t=this._result.reverse().slice(0)}finally{this._cleanup()}return t},_cleanup:function(){var e=this._configParser.getModules();for(var t in e)if(hasOwnProperty.call(e,t)){var n=e[t];n.conditionalMark=!1,n.mark=!1,n.tmpMark=!1}this._queue.length=0,this._result.length=0},_processConditionalModules:function(e){var t=this._configParser.getConditionalModules()[e.name];if(t&&!e.conditionalMark){for(var n=this._configParser.getModules(),r=0;r<t.length;r++){var i=n[t[r]];-1===this._queue.indexOf(i.name)&&this._testConditionalModule(i.condition.test)&&this._queue.push(i.name)}e.conditionalMark=!0}},_resolveDependencies:function(){for(var e=this._configParser.getModules(),t=0;t<this._queue.length;t++){var n=e[this._queue[t]];n.mark||this._visit(n)}},_testConditionalModule:function(testFunction){return"function"==typeof testFunction?testFunction():eval("false || "+testFunction)()},_visit:function(e){if(e.tmpMark)throw new Error("Error processing module: "+e.name+". The provided configuration is not Directed Acyclic Graph.");if(this._processConditionalModules(e),!e.mark){e.tmpMark=!0;for(var t=this._configParser.getModules(),n=0;n<e.dependencies.length;n++){var r=e.dependencies[n];if("exports"!==r){var i=t[r];this._visit(i,t)}}e.mark=!0,e.tmpMark=!1,this._result.unshift(e.name)}},_queue:[]},DependencyBuilder}),function(e,t){"use strict";var n=t(e);"object"==typeof module&&module&&(module.exports=n),"function"==typeof define&&define.amd&&define(t),e.URLBuilder=n}("undefined"!=typeof global?global:this,function(){"use strict";function e(e){this._configParser=e}return e.prototype={constructor:e,build:function(e){var t=[],n=[],r=this._configParser.getModules(),i=this._configParser.getConfig(),o=i.basePath;"/"!==o.charAt(o.length-1)&&(o+="/");for(var s=0;s<e.length;s++){var u=r[e[s]];u.fullPath?n.push(u.fullPath):i.combine?t.push(this._getModulePath(u)):n.push(i.url+o+this._getModulePath(u)),u.load=!0}return t.length&&(n.push(i.url+"?"+o+t.join("&"+o)),t.length=0),n},_getModulePath:function(e){return e.path?e.path:e.name.indexOf(".js")!==e.name.length-3?e.name+".js":e.name}},e}),function(e,t){"use strict";var n=t(e);"object"==typeof module&&module&&(module.exports=n),"function"==typeof define&&define.amd&&define(t),e.Loader=new n,e.require=e.Loader.require.bind(e.Loader),e.define=e.Loader.define.bind(e.Loader)}("undefined"!=typeof global?global:this,function(e){"use strict";function t(n){t.superclass.constructor.apply(this,arguments),this._config=n||e.__CONFIG__}function n(e,t,n){if(!t||!e)throw"extend failed, verify dependencies";var i=t.prototype,o=Object.create(i);return e.prototype=o,o.constructor=e,e.superclass=i,t!=Object&&i.constructor==Object.prototype.constructor&&(i.constructor=t),n&&r(o,n),e}function r(e,t){var n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e}return n(t,e.EventEmitter,{define:function(e,t,n,r){var i=this;return new Promise(function(o){var s=r||{};s.name=e,s.dependencies=t,s.pendingImplementation=n,i._getConfigParser().resolvePath(s);var u=i._checkModuleDependencies(s);u?(i._registerModule(s),o(s)):i._waitForImplementation(s).then(function(e){i._registerModule(e)})})},getConditionalModules:function(){return this._getConfigParser().getConditionalModules()},getModules:function(){return this._getConfigParser().getModules()},require:function(){var e,t,n,r=this,i=Array.isArray?Array.isArray(arguments[0]):"[object Array]"===Object.prototype.toString.call(arguments[0]);if(i)t=arguments[0],n="function"==typeof arguments[1]?arguments[1]:null,e="function"==typeof arguments[2]?arguments[2]:null;else{t=[];for(var o=0;o<arguments.length;++o)if("string"==typeof arguments[o])t[o]=arguments[o];else if("function"==typeof arguments[o]){n=arguments[o],e="function"==typeof arguments[++o]?arguments[o]:null;break}}r._resolveDependencies(t).then(function(e){return r._loadModules(e)}).then(function(){var e=r._addModuleImplementations(t);n&&n.apply(n,e)},function(t){e&&e.call(e,t)})},_addModuleImplementations:function(e){for(var t=[],n=this._getConfigParser().getModules(),r=0;r<e.length;r++){var i=n[e[r]];t.push(i?i.implementation:void 0)}return t},_checkModuleDependencies:function(e){for(var t=this._getConfigParser().getModules(),n=!0,r=e.dependencies,i=0;i<r.length;i++){var o=r[i];if("exports"!==o){var s=t[o];if(!s)throw"Dependency "+r[i]+" not registered as module.";var u=s.implementation;if(!u){n=!1;break}}}return n},_getConfigParser:function(){return this._configParser||(this._configParser=new e.ConfigParser(this._config)),this._configParser},_getDependencyBuilder:function(){return this._dependencyBuilder||(this._dependencyBuilder=new e.DependencyBuilder(this._getConfigParser())),this._dependencyBuilder},_getURLBuilder:function(){return this._urlBuilder||(this._urlBuilder=new e.URLBuilder(this._getConfigParser())),this._urlBuilder},_filterModulesNoImpl:function(e){for(var t=[],n=this._getConfigParser().getModules(),r=0;r<e.length;r++){var i=n[e[r]];"exports"===i||i&&i.implementation||t.push(e[r])}return t},_filterNotLoadedModules:function(e){for(var t=[],n=this._getConfigParser().getModules(),r=0;r<e.length;r++){var i=n[e[r]];"exports"===i||i&&(i.implementation||i.load)||t.push(e[r])}return t},_loadModules:function(e){var t=this;return new Promise(function(n,r){var i=t._filterNotLoadedModules(e);if(i.length){for(var o=t._getURLBuilder().build(i),s=[],u=0;u<o.length;u++)s.push(t._loadScript(o[u]));Promise.all(s).then(function(){return t._waitForImplementations(e)}).then(function(e){n(e)}).catch(function(e){r(e)})}else t._waitForImplementations(e).then(function(e){n(e)}).catch(function(e){r(e)})})},_registerModule:function(e){for(var t,n=[],r=this._getConfigParser(),i=r.getModules(),o=0;o<e.dependencies.length;o++){var s,u=e.dependencies[o];if("exports"===u)t={},n.push(t);else{var a=i[u];s=a.implementation,n.push(s)}}var l=e.pendingImplementation.apply(e.pendingImplementation,n);e.implementation=l||t,r.addModule(e),this.emit("moduleRegister",e)},_resolveDependencies:function(e){var t=this;return new Promise(function(n,r){try{for(var i=t._getConfigParser().getModules(),o=[],s=0;s<e.length;s++)i[e[s]]&&o.push(e[s]);var u=t._getDependencyBuilder().resolveDependencies(o);n(u)}catch(a){r(a)}})},_loadScript:function(e){return new Promise(function(t,n){var r=document.createElement("script");r.src=e,r.onload=r.onreadystatechange=function(){this.readyState&&"complete"!==this.readyState&&"load"!==this.readyState||(r.onload=r.onreadystatechange=null,t(r))},r.onerror=function(){document.body.removeChild(r),n(r)},document.body.appendChild(r)})},_waitForImplementation:function(e){var t=this;return new Promise(function(n){if(e.implementation)n(e);else{var r=function(){var i=t._checkModuleDependencies(e);i&&(t.off("moduleRegister",r),n(e))};t.on("moduleRegister",r)}})},_waitForImplementations:function(e){var t=this;return new Promise(function(n){var r=t._filterModulesNoImpl(e);if(r.length){for(var i=[],o=t._getConfigParser().getModules(),s=0;s<e.length;s++)i.push(t._waitForImplementation(o[r[s]]));Promise.all(i).then(function(e){n(e)})}else n(e)})}}),t}),window.Loader=global.Loader,window.require=global.require,window.define=global.define}();